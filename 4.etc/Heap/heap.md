[TOC]

# heap sort (힙 정렬)

## 개요

> **힙 정렬**(Heapsort)이란 최대  힙 트리나 최소 힙 트리를 구성해 정렬을 하는 방법

- 내림차순 정렬을 위해서는 최대 힙을 구성한다.
- 오름차순 정렬을 위해서는 최소 힙을 구성한다.
- 일반적인 경우 O(nlogn)의 시간복잡도를 가진다.

## 알고리즘

### 힙 구성

1. n개의 노드에 대한 이진 트리를 구성한다. 

   | 0    | 1    | 2    | 3    | 4    | 5    | 6    |
   | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
   | 3    | 6    | 2    | 7    | 5    | 1    | 4    |

2. 가장 오른쪽 리프노드의 부모 노드 부터 힙 구성을 시작한다. 

   - 노드의 index는 노드의 개수 / 2 - 1로 구 할 수 있다.

   | 0    | 1    | 2       | 3    | 4    | 5    | 6    |
   | ---- | ---- | ------- | ---- | ---- | ---- | ---- |
   | 3    | 6    | _**2**_ | 7    | 5    | 1    | 4    |

3. 자식노드와 비교하여 가장 큰 / 작은 노드를 부모노드로 결정한다.

   | 0    | 1    | 2                 | 3    | 4    | 5       | 6                |
   | ---- | ---- | ----------------- | ---- | ---- | ------- | ---------------- |
   | 3    | 6    | ~~2~~  -> _**4**_ | 7    | 5    | _**1**_ | ~~4~~ -> _**2**_ |

4. Root노드 까지(2 -> 1 -> 0) 기준을 이동하면서 힙을 구성한다. 

5. 교환이 발생한 경우교환한 자식노드를 기준으로 힙 구성을 재귀적으로 수행한다.

   - 1, 2번째 노드에 대한 힙구성을 하고 난 뒤에는 이 상태이다.

   | 0       | 1       | 2       | 3    | 4    | 5    | 6    |
   | ------- | ------- | ------- | ---- | ---- | ---- | ---- |
   | _**3**_ | _**7**_ | _**4**_ | 6    | 5    | 1    | 2    |

   - 최대 힙 구성을 위해 루트노드와 1번 노드를 교환한다.

   | 0       | 1       | 2       | 3    | 4    | 5    | 6    |
   | ------- | ------- | ------- | ---- | ---- | ---- | ---- |
   | _**7**_ | _**3**_ | _**4**_ | 6    | 5    | 1    | 2    |

   - 교환이 발생한 1번 노드를 기준으로 힙 구성을 다시 수행한다.

   | 0    | 1                | 2    | 3                | 4       | 5    | 6    |
   | ---- | ---------------- | ---- | ---------------- | ------- | ---- | ---- |
   | 7    | ~~3~~ -> _**6**_ | 4    | ~~6~~ -> _**3**_ | _**5**_ | 1    | 2    |


### 정렬

1. n개의 노드에 대한 최대/최소 힙을 구성한다.

   | 0    | 1    | 2    | 3    | 4    | 5    | 6    |
   | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
   | 7    | 6    | 4    | 3    | 5    | 1    | 2    |

2. 루트 노드(가장 큰/작은 수)와 가장 마지막 노드와 교환한다.

   | 0          | 1    | 2    | 3    | 4    | 5    | 6          |
   | ---------- | ---- | ---- | ---- | ---- | ---- | ---------- |
   | ~~7~~ -> 2 | 6    | 4    | 3    | 5    | 1    | ~~2~~ -> 7 |

3. 최대/최소 힙을 재 구성한다.

   - 힙 구성 전
   | 0       | 1       | 2       | 3    | 4    | 5    | 6    |
   | ------- | ------- | ------- | ---- | ---- | ---- | ---- |
   | _**2**_ | _**6**_ | _**4**_ | 3    | 5    | 1    | 7    |

   - 힙 구성
     - 0번, 1번, 2번 노드를 비교하여 가장 큰 1번 노드와 0번 노드를 교환한다.
     - 1번, 3번, 4번 노드를 비교하여 가장 큰 4번 노드와 1번 노드를 교환한다.
   - 힙 구성 후

   | 0    | 1    | 2    | 3    | 4    | 5    | 6    |
   | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
   | 6    | 5    | 4    | 3    | 2    | 1    | 7    |

4. 정렬이 완료될 때 까지 3~4를 반복한다.

   | 0    | 1    | 2    | 3    | 4    | 5    | 6    |
   | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
   | 1    | 2    | 3    | 4    | 5    | 6    | 7    |

